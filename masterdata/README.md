# Master Data Registry

A blockchain-powered global master data registry for products and materials. Replace fragmented ERP-specific master data with a single source of truth on the blockchain.

## üéØ Why Global Master Data?

### The Problem with Traditional Master Data

**Every company maintains their own master data:**
- Company A: Steel Pipe 12mm ‚Üí SKU: SP-001
- Company B: Steel Pipe 12mm ‚Üí SKU: PIPE-12-ST
- Company C: Steel Pipe 12mm ‚Üí SKU: MTL-789

**Result:**
- ‚ùå No common reference across organizations
- ‚ùå Duplicate data maintenance in every ERP system
- ‚ùå Integration nightmares for supply chains
- ‚ùå Inconsistent specifications and descriptions
- ‚ùå Manual reconciliation between systems

### The Blockchain Solution

**One material registered once, referenced everywhere:**
- Steel Pipe 12mm ‚Üí Blockchain Address: `87Vm...yhK1`
- All companies reference the same on-chain master data
- Specifications are immutable and transparent
- No duplicate maintenance needed

**Benefits:**
- ‚úì **Single Source of Truth**: One registration, universal reference
- ‚úì **No Data Silos**: All companies access the same data
- ‚úì **Immutable Records**: Blockchain-verified specifications
- ‚úì **Universal Reference**: Use blockchain addresses in any ERP/MRP system
- ‚úì **Supply Chain Transparency**: Everyone sees the same material data
- ‚úì **Cost Reduction**: Eliminate duplicate master data maintenance

## Use Case Example

### Traditional Way (Fragmented)
```
Supplier registers material in their ERP:
- Material: "Stainless Steel Bolt M8x20"
- Their SKU: "BOLT-M8-SS-20"

Manufacturer needs same material:
- Creates own master data entry
- Their SKU: "MTL-8877"
- Tries to match specifications manually

Distributor also needs it:
- Creates another entry
- Their SKU: "HW-001-M8"
- More manual reconciliation
```

### Blockchain Way (Unified)
```
Anyone registers material ONCE as an "asset" on the Nexus blockchain in a  standard format pre-defined by Distordia, generating a unique address in the asset's json element on-chain:
- Material: "Stainless Steel Bolt M8x20"
- Blockchain Address: 87VmNhitFJv3WA3Yrovt9A3hts2...

Everyone references this address:
- Supplier: Links address to their internal SKU
- Manufacturer: References same address
- Distributor: Uses same address
- All see identical specifications automatically
```

## Product Asset Schema

Products are stored as Nexus blockchain assets with a **maximum size of 1KB**. The schema is based on global ERP standards (SAP, Oracle, Microsoft Dynamics) and international specifications (GS1, UN/CEFACT, ISO).

### System Attributes (Auto-Generated by Nexus)

| Attribute | Type | Description |
|-----------|------|-------------|
| `address` | string | Unique blockchain identifier for this asset |
| `owner` | string | Blockchain address of asset owner (genesis ID) |
| `created` | integer | Unix timestamp of asset creation |
| `modified` | integer | Unix timestamp of last modification |
| `version` | integer | Asset version number (increments on update) |
| `type` | string | Always "OBJECT" for assets |
| `form` | string | Always "ASSET" for assets |

### Distordia Standard Attributes

| Attribute | Required | Type | Description | Values |
|-----------|----------|------|-------------|--------|
| `distordia-type` | ‚úì | string | Asset type identifier | `product` |
| `distordia-status` | ‚úì | string | Lifecycle status | `valid`, `discontinued`, `recalled` |

### Identification Attributes

| Attribute | Required | Type | Description | Standard |
|-----------|----------|------|-------------|----------|
| `art-nr` | ‚úì | string | Internal article/part number | Free text (max 50 chars) |
| `GTIN` | | string | Global Trade Item Number (barcode) | GS1 (8-14 digits) |
| `brand` | | string | Brand name (if different from manufacturer) | Free text (max 50 chars) |

**art-nr**: Your internal article or part number. This becomes part of the asset name on the blockchain (e.g., `product-BV-DN25-TH`).

**GTIN**: The Global Trade Item Number is the barcode number (EAN, UPC, GTIN-13, GTIN-14) assigned by GS1. Enables scanning and global identification across all retail and supply chain systems.

**brand**: The brand name if different from the manufacturer. Useful when a manufacturer produces products for multiple brands or private labels.

### Classification Attributes

| Attribute | Required | Type | Description | Standard |
|-----------|----------|------|-------------|----------|
| `category` | ‚úì | string | Human-readable product category | Free text (max 50 chars) |
| `subcategory` | | string | More specific classification | Free text (max 50 chars) |
| `GPC` | | string | GS1 Global Product Classification | 8-digit code |
| `HSCode` | | string | Harmonized System code for trade | 6-10 digits |

**category/subcategory**: Human-readable classification for browsing and filtering. Use industry-standard terms where possible.

**GPC**: GS1 Global Product Classification is an 8-digit code that provides standardized product categorization across industries. Essential for retail and GDSN synchronization. [Learn more ‚Üí](https://www.gs1.org/standards/gpc)

**HSCode**: Harmonized System code (6-10 digits) used internationally for customs classification and trade. Required for import/export documentation and duty calculation.

### Description Attributes

| Attribute | Required | Type | Description | Standard |
|-----------|----------|------|-------------|----------|
| `description` | ‚úì | string | Concise product description | Free text (max 100 chars) |
| `manufacturer` | ‚úì | string | Manufacturer name or GLN | Free text or 13-digit GLN |
| `origin` | | string | Country of origin | ISO 3166-1 alpha-2 (e.g., DE, US, CN) |

**description**: A concise product description (maximum 100 characters). Should clearly identify the product without marketing language.

**manufacturer**: The manufacturer name or their GLN (Global Location Number) for standardized identification. Using GLN enables automated lookups in GS1 databases.

**origin**: Country of origin using ISO 3166-1 alpha-2 codes. Important for trade compliance, customs, and origin labeling requirements.

### Physical Property Attributes

| Attribute | Required | Type | Description | Standard |
|-----------|----------|------|-------------|----------|
| `UOM` | ‚úì | string | Base unit of measure | UN/CEFACT codes |
| `weight` | | integer | Net weight per unit in grams | Integer (grams) |
| `hazardous` | | boolean | Dangerous goods flag | `true`/`false` |
| `perishable` | | boolean | Temperature-sensitive product | `true`/`false` |
| `shelflife` | | integer | Shelf life in days (if perishable) | Integer (days) |

**UOM**: Unit of Measure using UN/CEFACT Recommendation 20 codes:
- `EA` = Each
- `PC` = Piece  
- `SET` = Set
- `PR` = Pair
- `KG` = Kilogram
- `GRM` = Gram
- `LTR` = Liter
- `MTR` = Meter
- `MTK` = Square Meter
- `MTQ` = Cubic Meter
- `TNE` = Metric Ton
- `BX` = Box
- `CT` = Carton
- `PF` = Pallet

**weight**: Net weight per base unit in grams. Essential for logistics, shipping calculations, and trade documentation.

**hazardous**: Indicates dangerous goods requiring special handling, storage, or transport according to regulations (ADR, IMDG, IATA DGR).

**perishable**: Temperature-sensitive products requiring cold chain management.

**shelflife**: Number of days the product remains usable from manufacture date. Required for perishable goods inventory management.

### Reference Attributes

| Attribute | Required | Type | Description | Standard |
|-----------|----------|------|-------------|----------|
| `url` | | string | Link to extended product info | URL without https:// |
| `replaces` | | string | Superseded product address | Nexus blockchain address |

**url**: Link to extended product information (specification sheets, images, safety data sheets, etc.) stored off-chain. Keeps the on-chain asset under 1KB while enabling rich data.

**replaces**: If this product supersedes another, enter the blockchain address of the old product. Enables traceability for product lifecycle management.

### Example Asset JSON

```json
{
    "owner": "a164ce40f9522d2c436b17f9842a408508009780a594e1de3c7fca63ea3266aa",
    "version": 1,
    "created": 1766848496,
    "modified": 1766848496,
    "type": "OBJECT",
    "form": "ASSET",
    "distordia-type": "product",
    "distordia-status": "valid",
    "art-nr": "BV-DN25-TH",
    "GTIN": "00012345678905",
    "category": "Piping",
    "subcategory": "Valves",
    "GPC": "40161500",
    "HSCode": "848180",
    "description": "Ball Valve DN25 Threaded Brass",
    "manufacturer": "Distordia",
    "brand": "FlowMaster",
    "origin": "DE",
    "UOM": "EA",
    "weight": 2320,
    "hazardous": false,
    "perishable": false,
    "url": "distordia.com/products/bv-dn25"
}
```

This example uses approximately **450 bytes**, well within the 1KB limit.

## What Stays Off-Chain?

Due to the 1KB asset limit, the following should be stored in private company systems and linked via the `url` field:

| Category | Data Types |
|----------|------------|
| **Pricing** | List prices, customer-specific prices, discounts, currency |
| **Inventory** | Stock levels, warehouse locations, reorder points, safety stock |
| **Media** | Product images, videos, 3D models, PDF documents |
| **Long Descriptions** | Marketing text, translations, detailed specifications |
| **Dimensions** | Detailed physical dimensions, packaging dimensions |
| **Supplier Data** | Lead times, MOQs, supplier-specific codes, costs |
| **Customer Data** | Customer-specific names, cross-references |
| **Compliance** | Certificates, SDS documents, regulatory approvals (link only) |

## Features

### üîê Wallet Authentication
- Secure authentication via Q-Wallet browser extension
- Connect/disconnect wallet functionality
- No username/password login required

### üì¶ Master Data Management
- **Register Materials**: Create blockchain-based master data records
- **Universal Reference**: Each material gets a unique blockchain address
- **View All Materials**: Browse the global master data registry
- **Search & Filter**: Find materials by description, article number, category, or manufacturer
- **Material Details**: View comprehensive specifications and blockchain data
- **My Materials**: Filter to show materials you've registered

### üîó Blockchain Integration
- All materials stored as Assets on the Nexus blockchain
- Immutable product records with timestamps
- Ownership tracking and transfer capabilities
- Transaction history for each material
- Universal addressing for cross-company reference

## Integration with ERP/MRP Systems

### Step 1: Register Material
Register your material once on the blockchain and get a unique address.

### Step 2: Link to Internal Systems
In your ERP/MRP system, store the blockchain address alongside your internal article number:
```
Internal Art-Nr: BV-DN25-TH
Blockchain Reference: 87VmNhitFJv3WA3Yrovt9A3hts2MoXcfExyy9LiXyhK1sdThwYM
```

### Step 3: Share with Partners
Share the blockchain address with suppliers, customers, or partners. They can:
- View the authoritative material specifications
- Reference the same material in their systems
- Verify specifications without manual data entry

### Step 4: Query via API
```javascript
// List all valid products
POST https://api.distordia.com/register/list/assets:asset
{
  "where": "results.distordia-type=product AND results.distordia-status=valid"
}

// Get specific product by address
POST https://api.distordia.com/register/get/assets:asset
{
  "address": "<product_blockchain_address>"
}
```

## Technical Implementation

### Architecture
```
masterdata/
‚îú‚îÄ‚îÄ index.html       # Main HTML structure with form and modals
‚îú‚îÄ‚îÄ masterdata.css   # Styling including form sections and tables
‚îú‚îÄ‚îÄ masterdata.js    # Main UI logic and form handling
‚îú‚îÄ‚îÄ auth.js          # Q-Wallet authentication module
‚îú‚îÄ‚îÄ api.js           # Nexus blockchain API module
‚îî‚îÄ‚îÄ README.md        # Documentation
```

### Modules

#### auth.js - Wallet Authentication
- Handles Q-Wallet connection and disconnection
- Manages wallet connection state
- Provides UI feedback for connection status

#### api.js - Nexus API
- Interfaces with Nexus blockchain API
- Asset creation with schema validation
- Product data parsing and filtering

#### masterdata.js - Main Application
- Form section management with validation
- Product listing, filtering, and display
- Info tooltips and popup help system
- Shelf life field toggle for perishable products

## Usage

### For Users

1. **Connect Wallet**
   - Click "Connect Wallet" button
   - Approve connection in Q-Wallet popup
   - Your wallet address will be displayed

2. **Browse Products**
   - Products are automatically loaded from blockchain
   - Use search bar to find by description, article number, or manufacturer
   - Filter by category or ownership

3. **Register New Product**
   - Click "Register Material" button (visible when connected)
   - Fill in required fields in each section:
     - **Identification**: Article number (required), GTIN, Brand
     - **Classification**: Category (required), Subcategory, GPC, HS Code
     - **Description**: Description (required), Manufacturer (required), Origin
     - **Physical Properties**: UOM (required), Weight, Hazardous/Perishable flags
     - **References**: Product URL, Replaces address
   - Click ‚ÑπÔ∏è buttons for detailed field explanations
   - Submit to register on blockchain
   - Q-Wallet will prompt for PIN confirmation

4. **View Product Details**
   - Click any product card to view full details
   - See all attributes organized by category
   - View blockchain information and timestamps
   - Access external URL for extended specifications

### For Developers

#### Creating a Product Asset

```javascript
const productData = {
    'distordia-type': 'product',
    'distordia-status': 'valid',
    'art-nr': 'BV-DN25-TH',
    'GTIN': '00012345678905',
    'category': 'Piping',
    'subcategory': 'Valves',
    'GPC': '40161500',
    'HSCode': '848180',
    'description': 'Ball Valve DN25 Threaded Brass',
    'manufacturer': 'Distordia',
    'brand': 'FlowMaster',
    'origin': 'DE',
    'UOM': 'EA',
    'weight': 2320,
    'hazardous': false,
    'perishable': false,
    'url': 'distordia.com/products/bv-dn25'
};

// Via Q-Wallet
const result = await window.nexus.sendTransaction({
    type: 'asset.create',
    data: productData,
    name: `product-${productData['art-nr']}`
});
```

#### Querying Products

```javascript
// List all valid products
const products = await nexusAPI.listAllProducts();

// Filter products client-side
const filtered = nexusAPI.filterProducts(products, {
    category: 'Piping',
    search: 'valve',
    owner: 'mine'
});
```

## API Reference

### Nexus Blockchain Endpoints Used

- `assets/create/asset` - Register new product
- `assets/get/asset` - Retrieve product details  
- `register/list/assets:asset` - List all products with filtering
- `assets/update/asset` - Update product information
- `assets/transfer/asset` - Transfer product ownership
- `assets/history/asset` - Get transaction history

## Security

- All transactions require user approval via Q-Wallet
- PIN verification required for on-chain operations
- No private keys or sensitive data stored in browser
- All product data is publicly visible on blockchain

## Browser Compatibility

- Modern browsers with ES6+ support
- Q-Wallet browser extension required for wallet functionality
- Responsive design for mobile and desktop

## International Standards Referenced

| Standard | Organization | Usage |
|----------|--------------|-------|
| GTIN | GS1 | Global product identification (barcodes) |
| GPC | GS1 | Product classification |
| GLN | GS1 | Location/party identification |
| HS Code | WCO | International trade classification |
| UN/CEFACT Rec 20 | UNECE | Unit of measure codes |
| ISO 3166-1 | ISO | Country codes |

## Future Enhancements

- [ ] Product image uploads (IPFS integration)
- [ ] QR code generation for products
- [ ] Batch product registration via CSV
- [ ] Export products to CSV/JSON
- [ ] Product categories autocomplete
- [ ] GPC/HS code lookup integration
- [ ] Product transfer workflow
- [ ] Integration with supply chain tracking
- [ ] Multi-language description support
- [ ] GDSN synchronization

## License

Part of the Distordia project.
